rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Admin users can upload/delete files
    function isAdmin() {
      return request.auth != null && 
        request.auth.token.email in [
          'admin@mitoderm.com',
          'shiri@mitoderm.com',
          'segev@futurixs.com',
          'ilona@mitoderm.co.il'
        ];
    }
    
    // Product images
    match /products/{productId}/{fileName} {
      allow read: if true; // Anyone can view
      allow write: if isAdmin(); // Only admins can upload
    }
    
    // Video files
    match /videos/{videoId}/{fileName} {
      allow read: if true; // Anyone can view
      allow write: if isAdmin(); // Only admins can upload
    }
    
    // Thumbnails
    match /thumbnails/{videoId}/{fileName} {
      allow read: if true; // Anyone can view
      allow write: if isAdmin(); // Only admins can upload
    }
    
    // User avatars
    match /avatars/{userId}/{fileName} {
      allow read: if true; // Anyone can view
      allow write: if request.auth != null && request.auth.uid == userId; // Users can upload their own avatar
    }
  }
} 